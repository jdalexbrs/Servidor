<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Postulación GodestMC</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:"Poppins",sans-serif;
  min-height:100vh;
  background:linear-gradient(135deg,#0f172a,#1e3a8a,#0ea5e9);
  background-size:400% 400%;
  animation:bgFlow 18s ease infinite;
  display:flex;justify-content:center;align-items:center;
  padding:20px;color:#f1f5f9;
}
@keyframes bgFlow{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}
.container{
  width:100%;max-width:700px;
  background:rgba(255,255,255,0.06);
  border-radius:20px;
  padding:30px;
  backdrop-filter:blur(18px);
  box-shadow:0 10px 40px rgba(0,0,0,.4);
  animation:fadeIn .8s ease;
}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:none}}
h1{text-align:center;font-weight:800;font-size:2rem;margin-bottom:20px;color:#fff;text-shadow:0 0 10px rgba(14,165,233,.6)}
.progress{height:10px;background:rgba(255,255,255,0.15);border-radius:999px;overflow:hidden;margin:10px 0 25px;}
.progress i{display:block;height:100%;width:0%;background:linear-gradient(90deg,#0ea5e9,#38bdf8,#3b82f6);transition:width .6s cubic-bezier(.4,.0,.2,1);}
.step-card{display:none;animation:fadeIn .6s ease;}
.step-card.active{display:block;}
label{display:block;margin:14px 0 6px;font-size:.95rem;font-weight:600}
input,textarea,select{
  width:100%;padding:12px;border:none;border-radius:12px;
  background:rgba(255,255,255,0.1);color:#fff;font-size:1rem;outline:none;transition:.2s;
}
input::placeholder,textarea::placeholder{color:rgba(255,255,255,0.5)}
input:focus,textarea:focus,select:focus{background:rgba(255,255,255,0.2);box-shadow:0 0 0 2px #38bdf8;}
textarea{min-height:90px;resize:vertical}
select option{background:#0f172a;color:#f1f5f9;}
.controls{margin-top:20px;display:flex;justify-content:space-between;gap:12px;}
.btn{flex:1;background:linear-gradient(90deg,#3b82f6,#0ea5e9);padding:12px;border:none;border-radius:12px;color:#fff;font-weight:600;font-size:1rem;cursor:pointer;transition:.3s;box-shadow:0 6px 20px rgba(14,165,233,.4);}
.btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 24px rgba(14,165,233,.6)}
.btn:disabled{opacity:0.5;cursor:not-allowed}
.btn.ghost{background:transparent;border:2px solid rgba(255,255,255,.3);box-shadow:none;}
.btn.ghost:hover{background:rgba(255,255,255,.1)}
footer{margin-top:20px;text-align:center;font-size:.8rem;color:rgba(255,255,255,.6)}
@media(max-width:600px){
  .controls{flex-direction:column;}
  .btn{width:100%;}
}
</style>
</head>
<body>
<div class="container">
<h1>⚡ Postulaciones GodestMC</h1>
<div class="progress"><i id="bar"></i></div>
<div style="text-align:center;margin-bottom:15px">Pregunta <span id="currentStep">1</span> de <span id="totalSteps"></span></div>

<form id="applyForm">
  <!-- Pregunta 1: Rol -->
  <div class="step-card active" data-step="1">
    <label>¿Rol al que te postulas?*</label>
    <select name="role" required>
      <option value="">— Selecciona —</option>
      <option value="staff">Staff</option>
      <option value="dev">Dev</option>
      <option value="beta">Beta Tester</option>
    </select>
  </div>

  <!-- Pregunta 2 -->
  <div class="step-card" data-step="2">
    <label>Nick en Discord*</label>
    <input name="discord" required placeholder="Ej: mini_jdalex_brs">
  </div>

  <!-- Pregunta 3 -->
  <div class="step-card" data-step="3">
    <label>Nick en Minecraft*</label>
    <input name="mc" required placeholder="Ej: jdalexbrs">
  </div>

  <!-- Pregunta 4 -->
  <div class="step-card" data-step="4">
    <label>¿Has sido staff/dev/beta previamente?*</label>
    <textarea name="exp" required placeholder="Describe tu experiencia..."></textarea>
  </div>

  <!-- Pregunta 5 -->
  <div class="step-card" data-step="5">
    <label>País y zona horaria donde vives*</label>
    <input name="country" required placeholder="Ej: España (GMT+2)">
  </div>

  <!-- Pregunta 6 -->
  <div class="step-card" data-step="6">
    <label>Horas semanales que le puedes dedicar*</label>
    <input name="hours" type="number" required placeholder="Ej: 10">
  </div>

  <!-- Pregunta 7 -->
  <div class="step-card" data-step="7">
    <label>Días disponibles de la semana*</label>
    <input name="days" required placeholder="Ej: Lunes, Martes, Viernes">
  </div>

  <!-- Staff -->
  <div class="step-card staff-only" data-step="8">
    <label>En caso de que 2 usuarios se peleen, ¿qué harías?*</label>
    <textarea name="staff_conflict" placeholder="Describe tu plan de acción..."></textarea>
  </div>
  <div class="step-card staff-only" data-step="9">
    <label>¿Por qué quieres ser staff?*</label>
    <textarea name="staff_motive" placeholder="Explica tus motivaciones..."></textarea>
  </div>

  <!-- Dev -->
  <div class="step-card dev-only" data-step="8">
    <label>¿Qué lenguajes de programación dominas?*</label>
    <textarea name="dev_langs" placeholder="Ej: Java, JavaScript, Python..."></textarea>
  </div>
  <div class="step-card dev-only" data-step="9">
    <label>¿Sabes manejar eventos de Minecraft en código?*</label>
    <select name="dev_events">
      <option value="">— Selecciona —</option>
      <option value="sí">Sí</option>
      <option value="no">No</option>
    </select>
  </div>

  <!-- Beta -->
  <div class="step-card beta-only" data-step="8">
    <label>¿Por qué quieres ser Beta Tester?*</label>
    <textarea name="beta_motive" placeholder="Explica tus motivaciones..."></textarea>
  </div>
  <div class="step-card beta-only" data-step="9">
    <label>¿Qué prefieres: testear mecánicas o reportar errores?*</label>
    <textarea name="beta_pref" placeholder="Explica tu preferencia..."></textarea>
  </div>

  <!-- Final -->
  <div class="step-card" data-step="10">
    <label>¿Algo que añadir?</label>
    <textarea name="extra" placeholder="Información adicional (opcional)..."></textarea>
  </div>

  <div class="controls">
    <button type="button" id="prevBtn" class="btn ghost">Anterior</button>
    <button type="button" id="nextBtn" class="btn">Siguiente</button>
    <button type="submit" id="sendBtn" class="btn" style="display:none">Enviar</button>
  </div>
</form>
<footer>Creado con ❤️ por GodestMC</footer>
</div>

<script>
const webhookUrl = "https://discord.com/api/webhooks/1423267722862792805/2P-DP4l2RtxFF8oe6v2PfnOpT72ZnJQCC6rFu-X6oGY8iX_SbFwsRw6JEkFlsc4JJN6m";

const form = document.getElementById("applyForm");
const steps = Array.from(document.querySelectorAll(".step-card"));
const bar = document.getElementById("bar");
const currentStepEl = document.getElementById("currentStep");
const totalStepsEl = document.getElementById("totalSteps");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");
const sendBtn = document.getElementById("sendBtn");

let stepIndex = 0;
let chosenRole = null;

function getFilteredSteps() {
  return steps.filter(s => {
    if(s.classList.contains("staff-only")) return chosenRole==="staff";
    if(s.classList.contains("dev-only")) return chosenRole==="dev";
    if(s.classList.contains("beta-only")) return chosenRole==="beta";
    return true;
  });
}

function showStep(i){
  const filtered = getFilteredSteps();
  filtered.forEach((s,idx)=>s.classList.toggle("active",idx===i));
  bar.style.width = ((i+1)/filtered.length*100)+"%";
  currentStepEl.textContent = i+1;
  totalStepsEl.textContent = filtered.length;
  prevBtn.style.display = i===0?"none":"inline-block";
  nextBtn.style.display = i===filtered.length-1?"none":"inline-block";
  sendBtn.style.display = i===filtered.length-1?"inline-block":"none";
  validateStep();
}

function validateStep() {
  const filtered = getFilteredSteps();
  const currentFields = filtered[stepIndex].querySelectorAll("input[required],textarea[required],select[required]");
  const allFilled = Array.from(currentFields).every(f => f.value.trim() !== "");
  nextBtn.disabled = !allFilled;
  sendBtn.disabled = !allFilled;
}

steps.forEach(step => {
  step.querySelectorAll("input,textarea,select").forEach(field => {
    field.addEventListener("input", validateStep);
    field.addEventListener("change", validateStep);
  });
});

nextBtn.onclick=()=>{
  const filtered = getFilteredSteps();
  if(stepIndex<filtered.length-1){
    stepIndex++;
    showStep(stepIndex);
  }
};

prevBtn.onclick=()=>{
  if(stepIndex>0){
    stepIndex--;
    showStep(stepIndex);
  }
};

document.querySelector("select[name='role']").addEventListener("change", e=>{
  chosenRole = e.target.value;
  stepIndex = 0;
  showStep(stepIndex);
});

form.onsubmit = async e => {
  e.preventDefault();
  
  sendBtn.disabled = true;
  sendBtn.textContent = "Enviando...";
  
  const fd = new FormData(form);
  const data = Object.fromEntries(fd.entries());

  // Mapeo de nombres legibles para los campos
  const fieldNames = {
    role: "🎯 Rol",
    discord: "💬 Discord",
    mc: "🎮 Minecraft",
    exp: "📋 Experiencia Previa",
    country: "🌍 País/Zona Horaria",
    hours: "⏰ Horas Semanales",
    days: "📅 Días Disponibles",
    staff_conflict: "⚖️ Resolución de Conflictos",
    staff_motive: "💡 Motivación (Staff)",
    dev_langs: "💻 Lenguajes de Programación",
    dev_events: "🔧 Manejo de Eventos Minecraft",
    beta_motive: "💡 Motivación (Beta Tester)",
    beta_pref: "🔍 Preferencia de Testing",
    extra: "📝 Información Adicional"
  };

  // Crear campos solo con los datos completados
  const fields = [];
  for (const [key, value] of Object.entries(data)) {
    if (value && value.trim() !== "") {
      fields.push({
        name: fieldNames[key] || key,
        value: value.substring(0, 1024),
        inline: false
      });
    }
  }

  const payload = {
    username: "Postulaciones GodestMC",
    avatar_url: "https://i.imgur.com/8eU3Ggk.png",
    embeds: [{
      title: "📩 Nueva Postulación — GodestMC",
      description: `**Rol solicitado:** ${data.role.toUpperCase()}`,
      color: 0x0ea5e9,
      fields: fields,
      footer: {
        text: "GodestMC — Sistema de Postulación"
      },
      timestamp: new Date().toISOString()
    }]
  };

  try {
    const res = await fetch(webhookUrl, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(payload)
    });

    if (res.ok) {
      document.querySelector(".container").innerHTML = `
        <div style="text-align:center;padding:40px">
          <h1 style="font-size:3rem;margin-bottom:20px">✅</h1>
          <h2 style="font-size:1.8rem;margin-bottom:15px">¡Postulación enviada!</h2>
          <p style="margin-top:12px;font-size:1.1rem;color:#e2e8f0;line-height:1.6">
            Tu solicitud ha sido recibida correctamente.<br>
            <strong>Recuerda abrir un ticket en Discord</strong> para completar el proceso con las pruebas finales.
          </p>
          <p style="margin-top:20px;font-size:0.9rem;color:rgba(255,255,255,0.6)">
            ¡Buena suerte! 🍀
          </p>
        </div>
      `;
    } else {
      const errText = await res.text();
      alert("❌ Error al enviar la postulación: " + res.status + "\n" + errText);
      sendBtn.disabled = false;
      sendBtn.textContent = "Enviar";
    }
  } catch(err) {
    alert("❌ Error de conexión: " + err.message + "\nVerifica tu conexión e intenta nuevamente.");
    sendBtn.disabled = false;
    sendBtn.textContent = "Enviar";
  }
};

// Inicializar
showStep(stepIndex);
</script>
</body>
</html>
