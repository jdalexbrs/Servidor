<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>GodestMC — Postulaciones</title>
  <meta name="description" content="Postúlate a Staff / Dev / Beta Tester en GodestMC">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;800&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --blue-1:#123a6b; /* profundo */
      --blue-2:#2b6cb0; /* principal */
      --bronze:#b08d57; /* acento bronze edad de bronce */
      --bg:#071028;
      --card:#081827;
      --glass: rgba(255,255,255,0.04);
      --accent:#9fd3ff;
      --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;padding:0;font-family:Inter,system-ui,Segoe UI,Arial; background:radial-gradient(circle at 10% 10%, rgba(43,108,176,0.07), transparent 8%), linear-gradient(180deg,var(--bg), #020617 60%); color:#e6f0ff; -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-y:auto;
    }
    /* header */
    .container{max-width:1100px;margin:36px auto;padding:24px}
    header{display:flex;align-items:center;gap:18px}
    .logo{
      width:76px;height:76px;border-radius:12px;background:linear-gradient(135deg,var(--blue-2),var(--blue-1));display:flex;align-items:center;justify-content:center;box-shadow:0 8px 30px rgba(11,34,64,0.6);
      font-family:'Playfair Display',serif;font-weight:800;font-size:22px;color:var(--bronze)
    }
    h1{margin:0;font-family:'Playfair Display',serif;font-size:28px}
    p.lead{margin:6px 0 0;color:rgba(255,255,255,0.8)}

    /* hero */
    .hero{display:grid;grid-template-columns:1fr 420px;gap:20px;margin-top:18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:var(--radius);padding:18px;box-shadow:0 6px 24px rgba(3,8,16,0.6);border:1px solid rgba(255,255,255,0.03)}
    .intro h2{margin:0 0 8px 0;color:var(--accent)}
    .badges{display:flex;gap:8px;margin-top:12px}
    .badge{background:var(--glass);padding:6px 10px;border-radius:999px;font-size:14px;color:var(--accent);border:1px solid rgba(255,255,255,0.03)}

    /* form area */
    .form-wrap{display:flex;flex-direction:column;gap:12px}
    .step-card{background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.02)}
    label{display:block;font-size:13px;color:#dbeeff;margin-bottom:6px}
    input[type=text],input[type=email],select,textarea{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit;font-size:14px}
    textarea{min-height:90px;resize:vertical}
    .small{font-size:13px;color:#9fc1ff}

    .row{display:flex;gap:12px}
    .col{flex:1}

    .controls{display:flex;justify-content:space-between;align-items:center;margin-top:8px}
    .btn{background:linear-gradient(90deg,var(--blue-2),var(--blue-1));padding:10px 14px;border-radius:10px;border:none;color:white;font-weight:600;cursor:pointer;box-shadow:0 6px 18px rgba(43,108,176,0.25)}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}

    .progress{height:10px;background:rgba(255,255,255,0.03);border-radius:999px;overflow:hidden}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--bronze),var(--accent));width:0%;transition:width .4s cubic-bezier(.2,.9,.2,1)}

    /* responsive */
    @media (max-width:980px){.hero{grid-template-columns:1fr}}
    @media (max-width:560px){.row{flex-direction:column}}

    /* small footer */
    footer{margin-top:18px;text-align:center;color:rgba(255,255,255,0.6);font-size:13px}

    /* animation touches */
    .glow{box-shadow:0 6px 28px rgba(43,108,176,0.18)}
    .title-epic{font-family:'Playfair Display',serif;font-size:20px;color:var(--bronze);text-shadow:0 6px 22px rgba(176,141,87,0.08)}

    /* collapsible */
    details{background:rgba(255,255,255,0.02);padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.02)}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">GM</div>
      <div>
        <h1>GodestMC</h1>
        <p class="lead">Bienvenido a la web oficial de postulaciones. Moderno + Edad de Bronce: Zeus style ⚡</p>
      </div>
    </header>

    <main class="hero">
      <section class="card intro">
        <h2 class="title-epic">Postúlate al Staff Team</h2>
        <p>Gracias por dar el paso. Aquí se evaluará tu compromiso y actitud. Todas las postulaciones pasan a <strong>rango Postulante</strong> en prueba antes del rango final.</p>
        <div class="badges">
          <div class="badge">Requisito: +14 años</div>
          <div class="badge">Discord: 1 día / Servidor: 2h</div>
          <div class="badge">Micrófono (opcional)</div>
        </div>

        <hr style="margin:14px 0;border:0;border-top:1px solid rgba(255,255,255,0.03)">
        <p class="small">Selecciona a qué rol deseas postularte. El formulario adaptará las preguntas automáticamente.</p>

        <div style="margin-top:12px" class="step-card">
          <label for="role">¿A qué rol te postulas?</label>
          <select id="role">
            <option value="">— Selecciona un rol —</option>
            <option value="staff">Staff (Soporte)</option>
            <option value="dev">Dev</option>
            <option value="beta">Beta Tester</option>
          </select>
        </div>

        <details style="margin-top:12px">
          <summary>Configuración de envío (solo admins)</summary>
          <p class="small">La web puede enviar las postulaciones a un webhook de tu bot de Discord. Pega aquí tu webhook cuando lo tengas.</p>
          <label class="small">Webhook URL</label>
          <input id="admin-webhook" placeholder="https://... (opcional)" />
          <p class="small">También puedes dejarlo vacío y usar Formspree o descargar el JSON localmente.</p>
        </details>

      </section>

      <aside>
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between">
            <div>
              <div style="font-size:13px;color:#9fc1ff">Progreso</div>
              <div style="font-weight:700;font-size:16px">Sección <span id="currentSection">0</span> de 8</div>
            </div>
            <div style="text-align:right">
              <div class="small">Dominio:</div>
              <div style="font-weight:700">tienda.godestmc.website</div>
            </div>
          </div>

          <div style="margin-top:12px" class="progress"><i id="bar"></i></div>

          <div style="margin-top:14px">
            <div class="small">Guía rápida</div>
            <ol style="padding-left:16px;color:#cfe6ff">
              <li>Elige rol</li>
              <li>Completa las secciones</li>
              <li>Pulsa enviar y espera confirmación en Discord</li>
            </ol>
          </div>
        </div>

        <div style="margin-top:12px" class="card">
          <h3 style="margin-top:0">Contacto</h3>
          <p class="small">¿Dudas? Únete a nuestro Discord y abre un ticket.</p>
          <a class="btn" href="https://discord.gg/puedes-poner-tu-invite-aqui" target="_blank" rel="noreferrer">Ir al Discord</a>
        </div>
      </aside>

      <div style="grid-column:1 / -1;margin-top:18px" class="card form-wrap">
        <form id="applyForm">
          <!-- SECCIÓN 1: Bienvenida breve (no input) -->
          <div class="step-card" data-step="1">
            <h3>1. Introducción</h3>
            <p class="small">Lee con atención: postularte implica pasar por un periodo de pruebas. Responde con sinceridad.</p>
          </div>

          <!-- SECCIÓN 2: Información básica -->
          <div class="step-card" data-step="2">
            <h3>2. Información básica</h3>
            <label>Nick en Discord <span style="color:var(--bronze)">*</span></label>
            <input type="text" name="discord_nick" required placeholder="Ej: mini_jdalex_brs" />

            <label style="margin-top:8px">Nick en Minecraft <span style="color:var(--bronze)">*</span></label>
            <input type="text" name="mc_nick" required placeholder="Ej: jdalexbrs" />

            <label style="margin-top:8px">¿Has sido staff/dev/beta previamente? (indica servidor, fechas y rol)</label>
            <textarea name="prev_roles" placeholder="Ej: ServidorX — Moderador (2019-2020)"></textarea>
          </div>

          <!-- SECCIÓN 3: Disponibilidad -->
          <div class="step-card" data-step="3">
            <h3>3. Disponibilidad</h3>
            <label>País y zona horaria <span style="color:var(--bronze)">*</span></label>
            <input type="text" name="timezone" required placeholder="Ej: España: Zona horaria de Madrid (GMT+2)" />

            <div class="row" style="margin-top:8px">
              <div class="col">
                <label>Horas semanales que puedes dedicar <span style="color:var(--bronze)">*</span></label>
                <input type="text" name="hours_week" required placeholder="Ej: 5-10" />
              </div>
              <div class="col">
                <label>Días disponibles</label>
                <select name="days" multiple size="4">
                  <option>Lunes</option>
                  <option>Martes</option>
                  <option>Miércoles</option>
                  <option>Jueves</option>
                  <option>Viernes</option>
                  <option>Sábado</option>
                  <option>Domingo</option>
                </select>
              </div>
            </div>
          </div>

          <!-- SECCIÓN 4: Elegir rol -->
          <div class="step-card" data-step="4">
            <h3>4. Elegir rol</h3>
            <label>Confirmar rol elegido</label>
            <input type="text" id="roleConfirm" name="role_confirm" readonly />
            <label style="margin-top:8px">Descripción (opcional)</label>
            <textarea name="role_desc" placeholder="Qué te gustaría aportar a ese rol"></textarea>
          </div>

          <!-- SECCIÓN 5: ACCIONES (Staff) -->
          <div class="step-card role-only" data-step="5" data-role="staff">
            <h3>5. ACCIONES (Staff)</h3>
            <label>En caso de que 2 usuarios se peleen, ¿qué harías?</label>
            <textarea name="staff_conflict"></textarea>

            <label style="margin-top:8px">Ves a un amigo tuyo rompiendo reglas, ¿cómo reaccionarías?</label>
            <textarea name="staff_friend"></textarea>

            <label style="margin-top:8px">Si asciendes, ¿cómo sería tu comportamiento?</label>
            <textarea name="staff_promote"></textarea>

            <label style="margin-top:8px">¿Por qué elegirte a ti y no a otro postulante?</label>
            <textarea name="staff_why"></textarea>

            <label style="margin-top:8px">¿Por qué quieres ser staff?</label>
            <textarea name="staff_motive"></textarea>

            <label style="margin-top:8px">¿Qué significa ser staff en Godest?</label>
            <textarea name="staff_meaning"></textarea>

            <label style="margin-top:8px">Descríbete en pocas palabras</label>
            <input type="text" name="staff_self" />

            <label style="margin-top:8px">¿Respetarías decisiones del staff superior aunque no estés de acuerdo?</label>
            <select name="staff_respect"><option>Sí</option><option>No</option></select>

            <label style="margin-top:8px">¿Qué harías para mejorar la comunidad?</label>
            <textarea name="staff_improve"></textarea>
          </div>

          <!-- SECCIÓN 6: DEV -->
          <div class="step-card role-only" data-step="6" data-role="dev">
            <h3>6. DEV</h3>
            <label>¿Qué lenguajes de programación dominas?</label>
            <input type="text" name="dev_langs" placeholder="Ej: Java, JS, Kotlin" />

            <label style="margin-top:8px">¿Sabes manejar eventos de Minecraft en código?</label>
            <select name="dev_events"><option>Sí</option><option>No</option></select>

            <label style="margin-top:8px">¿Por qué quieres ser dev en Godest?</label>
            <textarea name="dev_why"></textarea>

            <label style="margin-top:8px">¿Qué significa para ti ser staff en un servidor?</label>
            <textarea name="dev_meaning"></textarea>
          </div>

          <!-- SECCIÓN 7: BETA TESTER -->
          <div class="step-card role-only" data-step="7" data-role="beta">
            <h3>7. BETA TESTER</h3>
            <label>¿Por qué quieres ser Beta Tester en Godest?</label>
            <textarea name="beta_why"></textarea>

            <label style="margin-top:8px">¿Por qué elegirte como tester?</label>
            <textarea name="beta_why2"></textarea>

            <label style="margin-top:8px">¿Te interesa más testear mecánicas o reportar errores visuales? ¿Por qué?</label>
            <textarea name="beta_focus"></textarea>
          </div>

          <!-- SECCIÓN 8: Opcional -->
          <div class="step-card" data-step="8">
            <h3>8. Opcional</h3>
            <label>¿Algo que añadir?</label>
            <textarea name="extra"></textarea>
            <p class="small">Recuerda abrir un ticket en Discord: allí se te harán unas últimas pruebas.</p>
          </div>

          <div class="controls">
            <div>
              <button type="button" id="prevBtn" class="btn ghost">Anterior</button>
            </div>
            <div style="display:flex;gap:8px;align-items:center">
              <div style="width:240px;text-align:center;font-size:13px;color:#9fc1ff">Sección activa: <strong id="activeLabel">—</strong></div>
              <button type="button" id="nextBtn" class="btn">Siguiente</button>
              <button type="submit" id="sendBtn" class="btn" style="display:none;">Enviar postulación</button>
            </div>
          </div>
        </form>
      </div>

    </main>

    <footer>
      <small>Creado para GodestMC — despliega en <strong>Servidor</strong> repository y configura <em>tienda.godestmc.website</em> en GitHub Pages.</small>
    </footer>
  </div>

  <script>
    /* -----------------------------
       Configuración (edítala)
       webhookUrl: pega aquí la URL de tu bot para que publique en Discord.
       ticketLink: enlace al canal/ticket en Discord.
       -----------------------------*/
    const webhookUrl = ""; // <-- pega el webhook de tu bot cuando lo tengas
    const ticketLink = "https://discord.gg/tu-invite-aqui";

    /* UI & lógica del formulario */
    const form = document.getElementById('applyForm');
    const steps = Array.from(document.querySelectorAll('[data-step]'));
    const roleSelect = document.getElementById('role');
    const roleConfirm = document.getElementById('roleConfirm');
    const roleOnly = Array.from(document.querySelectorAll('.role-only'));
    const bar = document.getElementById('bar');
    const currentSection = document.getElementById('currentSection');
    const activeLabel = document.getElementById('activeLabel');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const sendBtn = document.getElementById('sendBtn');
    const adminWebhookInput = document.getElementById('admin-webhook');

    let stepIndex = 0; // show intro (1) as first - we'll map to index 0

    function showStep(index){
      steps.forEach((s,i)=>{s.style.display = (i===index)?'block':'none'});
      // update role-only visibility based on selected role
      const role = roleSelect.value;
      roleOnly.forEach(el=>{ el.style.display = (el.dataset.role === role)?'block':'none' });
      // If role-only steps hidden, we still keep their steps in count but mark as skipped visually
      updateProgress(index+1);
      currentSection.innerText = Math.min(index+1, steps.length);
      activeLabel.innerText = steps[index].querySelector('h3')?.innerText || '—';

      // show/hide controls
      prevBtn.style.display = index===0?'none':'inline-block';
      nextBtn.style.display = index===steps.length-1?'none':'inline-block';
      sendBtn.style.display = index===steps.length-1?'inline-block':'none';
    }

    function updateProgress(active){
      const pct = Math.round((active / steps.length)*100);
      bar.style.width = pct + '%';
    }

    nextBtn.addEventListener('click', ()=>{
      if(stepIndex < steps.length-1) stepIndex++;
      showStep(stepIndex);
      window.scrollTo({top:0,behavior:'smooth'});
    });
    prevBtn.addEventListener('click', ()=>{
      if(stepIndex > 0) stepIndex--;
      showStep(stepIndex);
      window.scrollTo({top:0,behavior:'smooth'});
    });

    // role selection updates the roleConfirm and visibility of role sections
    roleSelect.addEventListener('change', ()=>{
      roleConfirm.value = roleSelect.options[roleSelect.selectedIndex].text;
      // show first real section (2) after selecting
      if(roleSelect.value) showStep(1);
    });

    // initial state
    showStep(0);

    // Form submit handler: gather only visible fields
    form.addEventListener('submit', async (ev)=>{
      ev.preventDefault();
      // collect form data
      const fd = new FormData(form);
      const payload = {};
      for(const [k,v] of fd.entries()){
        payload[k] = v;
      }
      payload['selected_role'] = roleSelect.value || 'no-seleccionado';
      payload['submitted_at'] = new Date().toISOString();

      // admin webhook override in UI
      const adminWebhook = adminWebhookInput.value.trim();
      const targetWebhook = adminWebhook || webhookUrl || null;

      try{
        if(targetWebhook){
          // send as simple JSON to your bot webhook.
          const res = await fetch(targetWebhook, {
            method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({type:'postulacion',data:payload})
          });
          if(!res.ok) throw new Error('Error en el webhook: '+res.status);
          showSuccess('Postulación enviada correctamente. Revisa el canal de staff en Discord.');
        } else {
          // fallback: let user download the JSON of the post
          const blob = new Blob([JSON.stringify(payload,null,2)],{type:'application/json'});
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a'); a.href = url; a.download = (payload.mc_nick || 'postulacion') + '.json';
          document.body.appendChild(a); a.click(); a.remove();
          showSuccess('No hay webhook configurado. Se ha descargado una copia JSON de la postulación.');
        }
      }catch(err){
        console.error(err); alert('Ha ocurrido un error al enviar la postulación: '+err.message);
      }
    });

    function showSuccess(message){
      const dlg = document.createElement('div');
      dlg.style.position='fixed';dlg.style.left='50%';dlg.style.top='14%';dlg.style.transform='translateX(-50%)';
      dlg.style.background='linear-gradient(90deg,var(--blue-2),var(--blue-1))';dlg.style.padding='18px';dlg.style.borderRadius='12px';dlg.style.boxShadow='0 10px 40px rgba(2,8,20,0.6)';dlg.style.zIndex=9999;
      dlg.innerHTML = `<div style="font-weight:700;margin-bottom:6px">¡Enviado!</div><div style="font-size:14px;margin-bottom:10px">${message}</div><div style="display:flex;gap:8px;justify-content:flex-end"><a class='btn' href='${ticketLink}' target='_blank'>Abrir ticket</a><button class='btn ghost' id='closeDlg'>Cerrar</button></div>`;
      document.body.appendChild(dlg);
      document.getElementById('closeDlg').addEventListener('click', ()=>dlg.remove());
    }

    // small UX: allow pressing Enter in selects to go next when not final
    form.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' && e.target.tagName !== 'TEXTAREA'){
        e.preventDefault(); if(stepIndex < steps.length-1){stepIndex++;showStep(stepIndex)}
      }
    });

    // Accessibility: focus first input on step show
    const observer = new MutationObserver(()=>{
      const inputs = steps[stepIndex]?.querySelectorAll('input,select,textarea');
      if(inputs && inputs.length) inputs[0].focus();
    });
    observer.observe(document.body,{childList:true,subtree:true});

  </script>
</body>
</html>
